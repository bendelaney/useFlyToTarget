<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>useFlyToTarget - Interactive Configurator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/MotionPathPlugin.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      overflow: hidden;
      background-color: #dad8d0;
    }

    .main-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    .controls-panel {
      position: absolute;
      top:  0px;
      left: 0px;
      z-index: 100;
      display: flex;
      gap: 20px;
    }

    .parameters-panel {
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      color: white;
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 360px;
      height: 100vh;
      overflow-y: auto;

      span {display: inline;}
    }

    .parameters-title {
      margin: 0;
      margin-bottom: 8px;
    }

    .parameter-label {
      display: block;
      font-size: 14px;
      padding: 6px 0;
    }

    .ease-select,
    .scale-ease-select {
      padding: 6px;
      border-radius: 4px;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .reset-button {
      margin-top: 8px;
      padding: 10px 16px;
      border-radius: 6px;
      border: none;
      color: white;
      font-weight: bold;
      transition: background 0.2s;
    }

    .reset-button.enabled {
      background: #4caf50;
      cursor: pointer;
    }

    .reset-button.disabled {
      background: #666;
      cursor: not-allowed;
    }

    .config-output-panel {
      min-height: 120px;
      max-height: 300px;
      overflow: auto;
      padding-top: 20px;
    }
      
    .config-output-content {
      padding: 10px;
      background: rgba(255, 255, 255, 0.25);
      border-radius: 12px;
      font-size: 12px;
      font-family: monospace;
      white-space: pre-wrap;
      word-break: break-all;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .target-circle {
      position: absolute;
      top: 80px;
      right: 120px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 100, 100, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dart-home {
      position: absolute;
      bottom: calc(100vh / 2);
      left: calc(100vw / 2);
    }

    .dart {
      width: 80px;
      height: 80px;
      z-index: 10000;
      position: absolute;
      border-radius: 50%;
      background: color(display-p3 0.29 0.68 0.31);
      user-select: none;
      box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 14px;
    }

    .dart:hover {
      transform: scale(1.05);
    }

    input[type="range"] {
      width: 100%;
    }
    a {color: white; text-decoration: underline;}
  </style>
</head>
<body>
  <div class="main-container">
    <!-- Controls Panel -->
    <div class="controls-panel">
      <div class="parameters-panel">
        <h2>useFlyToTarget</h2>
        <div><a href="https://github.com/bendelaney/useFlyToTarget">Github</a></div>
        <hr>
        <h3 class="parameters-title">Parameters</h3>

        <label class="parameter-label">
          Duration: <span id="duration-value">0.45</span>s
          <input type="range" id="duration" min="0.10" max="3.00" step="0.01" value="0.45">
        </label>

        <label class="parameter-label">
          Ease:
          <select class="ease-select" id="ease">
            <option value="none">none</option>
            <option value="power1.in">power1.in</option>
            <option value="power1.out">power1.out</option>
            <option value="power1.inOut">power1.inOut</option>
            <option value="power2.in">power2.in</option>
            <option value="power2.out">power2.out</option>
            <option value="power2.inOut">power2.inOut</option>
            <option value="power3.in">power3.in</option>
            <option value="power3.out" selected>power3.out</option>
            <option value="power3.inOut">power3.inOut</option>
            <option value="power4.in">power4.in</option>
            <option value="power4.out">power4.out</option>
            <option value="power4.inOut">power4.inOut</option>
            <option value="back.in">back.in</option>
            <option value="back.out">back.out</option>
            <option value="back.inOut">back.inOut</option>
            <option value="elastic.in">elastic.in</option>
            <option value="elastic.out">elastic.out</option>
            <option value="elastic.inOut">elastic.inOut</option>
            <option value="expo.in">expo.in</option>
            <option value="expo.out">expo.out</option>
            <option value="expo.inOut">expo.inOut</option>
            <option value="bounce.in">bounce.in</option>
            <option value="bounce.out">bounce.out</option>
            <option value="bounce.inOut">bounce.inOut</option>
            <option value="circ.in">circ.in</option>
            <option value="circ.out">circ.out</option>
            <option value="circ.inOut">circ.inOut</option>
          </select>
        </label>

        <label class="parameter-label">
          Swoop Amount: <span id="swoop-value">-100</span>px
          <input type="range" id="swoop" min="-200" max="200" step="10" value="-100">
        </label>

        <label class="checkbox-label">
          <input type="checkbox" id="scale" checked>
          Animate Scale
        </label>

        <div id="scale-controls">
          <label class="parameter-label">
            Scale Start Delay: <span id="scale-delay-value">0.00</span>
            <input type="range" id="scale-delay" min="0" max="1.0" step="0.01" value="0">
          </label>

          <label class="parameter-label">
            Scale Up Duration: <span id="scale-up-duration-value">0.20</span>s
            <input type="range" id="scale-up-duration" min="0.10" max="3.00" step="0.01" value="0.20">
          </label>

          <label class="parameter-label">
            Scale Up Ease:
            <select class="scale-ease-select" id="scale-up-ease">
              <option value="none">none</option>
              <option value="power1.in">power1.in</option>
              <option value="power1.out">power1.out</option>
              <option value="power1.inOut">power1.inOut</option>
              <option value="power2.in">power2.in</option>
              <option value="power2.out">power2.out</option>
              <option value="power2.inOut">power2.inOut</option>
              <option value="power3.in">power3.in</option>
              <option value="power3.out" selected>power3.out</option>
              <option value="power3.inOut">power3.inOut</option>
              <option value="power4.in">power4.in</option>
              <option value="power4.out">power4.out</option>
              <option value="power4.inOut">power4.inOut</option>
              <option value="back.in">back.in</option>
              <option value="back.out">back.out</option>
              <option value="back.inOut">back.inOut</option>
              <option value="elastic.in">elastic.in</option>
              <option value="elastic.out">elastic.out</option>
              <option value="elastic.inOut">elastic.inOut</option>
              <option value="expo.in">expo.in</option>
              <option value="expo.out">expo.out</option>
              <option value="expo.inOut">expo.inOut</option>
              <option value="bounce.in">bounce.in</option>
              <option value="bounce.out">bounce.out</option>
              <option value="bounce.inOut">bounce.inOut</option>
              <option value="circ.in">circ.in</option>
              <option value="circ.out">circ.out</option>
              <option value="circ.inOut">circ.inOut</option>
            </select>
          </label>

          <label class="parameter-label">
            Scale Peak: <span id="scale-peak-value">1.90</span>
            <input type="range" id="scale-peak" min="1.0" max="3.0" step="0.1" value="1.9">
          </label>

          <label class="parameter-label">
            Scale Pause: <span id="scale-pause-value">0.05</span>
            <input type="range" id="scale-pause" min="0" max="4.0" step="0.01" value="0.05">
          </label>

          <label class="parameter-label">
            Scale Down Duration: <span id="scale-down-duration-value">0.10</span>
            <input type="range" id="scale-down-duration" min="0" max="4.0" step="0.01" value="0.10">
          </label>

          <label class="parameter-label">
            Scale Down Ease:
            <select class="scale-ease-select" id="scale-down-ease">
              <option value="none" selected>none</option>
              <option value="power1.in">power1.in</option>
              <option value="power1.out">power1.out</option>
              <option value="power1.inOut">power1.inOut</option>
              <option value="power2.in">power2.in</option>
              <option value="power2.out">power2.out</option>
              <option value="power2.inOut">power2.inOut</option>
              <option value="power3.in">power3.in</option>
              <option value="power3.out">power3.out</option>
              <option value="power3.inOut">power3.inOut</option>
              <option value="power4.in">power4.in</option>
              <option value="power4.out">power4.out</option>
              <option value="power4.inOut">power4.inOut</option>
              <option value="back.in">back.in</option>
              <option value="back.out">back.out</option>
              <option value="back.inOut">back.inOut</option>
              <option value="elastic.in">elastic.in</option>
              <option value="elastic.out">elastic.out</option>
              <option value="elastic.inOut">elastic.inOut</option>
              <option value="expo.in">expo.in</option>
              <option value="expo.out">expo.out</option>
              <option value="expo.inOut">expo.inOut</option>
              <option value="bounce.in">bounce.in</option>
              <option value="bounce.out">bounce.out</option>
              <option value="bounce.inOut">bounce.inOut</option>
              <option value="circ.in">circ.in</option>
              <option value="circ.out">circ.out</option>
              <option value="circ.inOut">circ.inOut</option>
            </select>
          </label>

          <label class="parameter-label">
            Scale Target: <span id="scale-target-value">0.40</span>
            <input type="range" id="scale-target" min="0" max="4.0" step="0.1" value="0.4">
          </label>
        </div>

        <button id="reset-button" class="reset-button disabled" disabled>ðŸ”„ Reset</button>
      </div>

      <div class="config-output-panel">
        <div class="config-output-content" id="config-output"></div>
      </div>
    </div>

    <!-- Target - Upper Right -->
    <div id="target" class="target-circle"></div>

    <!-- Dart Home - Mid-Lower Left -->
    <div class="dart-home">
      <div id="dart" class="dart">Click me</div>
    </div>
  </div>

  <script>
    gsap.registerPlugin(MotionPathPlugin);

    // State
    let config = {
      motionDuration: 0.45,
      motionEase: 'power3.out',
      swoopAmount: -100,
      scale: true,
      scaleStartDelay: 0,
      scaleUpDuration: 0.2,
      scaleUpEase: 'power3.in',
      scalePeak: 1.9,
      scalePause: 0.05,
      scaleDownDuration: 0.1,
      scaleDownEase: 'none',
      scaleTarget: 0.4,
    };

    let isAtTarget = false;

    // Elements
    const dart = document.getElementById('dart');
    const target = document.getElementById('target');
    const resetButton = document.getElementById('reset-button');
    const scaleCheckbox = document.getElementById('scale');
    const scaleControls = document.getElementById('scale-controls');

    // useFlyToTarget implementation
    function flyToTarget(sourceElement, targetElement, userConfig) {
      const cfg = { ...config, ...userConfig };

      const sourceRect = sourceElement.getBoundingClientRect();
      const targetRect = targetElement.getBoundingClientRect();

      const currentX = gsap.getProperty(sourceElement, 'x') || 0;
      const currentY = gsap.getProperty(sourceElement, 'y') || 0;

      const targetX = currentX + (targetRect.left + targetRect.width / 2 - sourceRect.left - sourceRect.width / 2);
      const targetY = currentY + (targetRect.top + targetRect.height / 2 - sourceRect.top - sourceRect.height / 2);

      const tl = gsap.timeline({
        onComplete: () => {
          isAtTarget = true;
          updateResetButton();
        }
      });

      const motionConfig = {
        duration: cfg.motionDuration,
        ease: cfg.motionEase,
      };

      if (cfg.swoopAmount !== 0) {
        const midX = (currentX + targetX) / 2;
        const midY = (currentY + targetY) / 2;
        const dx = targetX - currentX;
        const dy = targetY - currentY;
        const perpX = -dy;
        const perpY = dx;
        const length = Math.sqrt(perpX * perpX + perpY * perpY);
        const normalizedPerpX = perpX / length;
        const normalizedPerpY = perpY / length;
        const controlX = midX + normalizedPerpX * cfg.swoopAmount;
        const controlY = midY + normalizedPerpY * cfg.swoopAmount;

        motionConfig.motionPath = {
          path: [
            { x: currentX, y: currentY },
            { x: controlX, y: controlY },
            { x: targetX, y: targetY }
          ],
          curviness: 2,
          resolution: 6,
        };
      } else {
        motionConfig.x = targetX;
        motionConfig.y = targetY;
      }

      tl.to(sourceElement, motionConfig, 0);

      if (cfg.scale) {
        const scaleConfig = {
          scale: cfg.scalePeak,
          delay: cfg.scaleStartDelay,
          duration: cfg.scaleUpDuration,
          ease: cfg.scaleUpEase,
        };

        const baseShadowBlur = 4;
        const startBlur = baseShadowBlur;
        const maxBlur = baseShadowBlur * cfg.scalePeak * 0.5;

        gsap.set(sourceElement, { boxShadow: `0px 2px ${startBlur}px rgba(0,0,0,0.3)` });
        scaleConfig.boxShadow = `0px 2px ${maxBlur}px rgba(0,0,0,0.6)`;

        tl.fromTo(sourceElement, { scale: 1 }, scaleConfig, 0);

        const scaleDownConfig = {
          delay: cfg.scalePause,
          scale: cfg.scaleTarget,
          duration: cfg.scaleDownDuration,
          ease: cfg.scaleDownEase,
          boxShadow: '0px 0px 0px rgba(0,0,0,0.0)',
        };

        tl.to(sourceElement, scaleDownConfig, `>${cfg.scaleStartDelay + cfg.scaleUpDuration}`);
      }

      return tl;
    }

    // Click handler
    function handleDartClick() {
      if (isAtTarget) return;
      flyToTarget(dart, target, config);
    }

    // Reset handler
    function handleReset() {
      if (!isAtTarget) return;

      gsap.killTweensOf(dart);
      gsap.set(dart, { x: 0, y: 0, rotation: 0, scale: 1 });

      isAtTarget = false;
      updateResetButton();
    }

    function updateResetButton() {
      if (isAtTarget) {
        resetButton.classList.remove('disabled');
        resetButton.classList.add('enabled');
        resetButton.disabled = false;
      } else {
        resetButton.classList.remove('enabled');
        resetButton.classList.add('disabled');
        resetButton.disabled = true;
      }
    }

    function updateConfig() {
      const configOutput = document.getElementById('config-output');
      configOutput.textContent = JSON.stringify(config, null, 2);
    }

    // Event listeners for controls
    document.getElementById('duration').addEventListener('input', (e) => {
      config.motionDuration = parseFloat(e.target.value);
      document.getElementById('duration-value').textContent = config.motionDuration.toFixed(2);
      updateConfig();
    });

    document.getElementById('ease').addEventListener('change', (e) => {
      config.motionEase = e.target.value;
      updateConfig();
    });

    document.getElementById('swoop').addEventListener('input', (e) => {
      config.swoopAmount = parseFloat(e.target.value);
      document.getElementById('swoop-value').textContent = config.swoopAmount;
      updateConfig();
    });

    scaleCheckbox.addEventListener('change', (e) => {
      config.scale = e.target.checked;
      scaleControls.style.display = e.target.checked ? 'block' : 'none';
      updateConfig();
    });

    document.getElementById('scale-delay').addEventListener('input', (e) => {
      config.scaleStartDelay = parseFloat(e.target.value);
      document.getElementById('scale-delay-value').textContent = config.scaleStartDelay.toFixed(2);
      updateConfig();
    });

    document.getElementById('scale-up-duration').addEventListener('input', (e) => {
      config.scaleUpDuration = parseFloat(e.target.value);
      document.getElementById('scale-up-duration-value').textContent = config.scaleUpDuration.toFixed(2);
      updateConfig();
    });

    document.getElementById('scale-up-ease').addEventListener('change', (e) => {
      config.scaleUpEase = e.target.value;
      updateConfig();
    });

    document.getElementById('scale-peak').addEventListener('input', (e) => {
      config.scalePeak = parseFloat(e.target.value);
      document.getElementById('scale-peak-value').textContent = config.scalePeak.toFixed(2);
      updateConfig();
    });

    document.getElementById('scale-pause').addEventListener('input', (e) => {
      config.scalePause = parseFloat(e.target.value);
      document.getElementById('scale-pause-value').textContent = config.scalePause.toFixed(2);
      updateConfig();
    });

    document.getElementById('scale-down-duration').addEventListener('input', (e) => {
      config.scaleDownDuration = parseFloat(e.target.value);
      document.getElementById('scale-down-duration-value').textContent = config.scaleDownDuration.toFixed(2);
      updateConfig();
    });

    document.getElementById('scale-down-ease').addEventListener('change', (e) => {
      config.scaleDownEase = e.target.value;
      updateConfig();
    });

    document.getElementById('scale-target').addEventListener('input', (e) => {
      config.scaleTarget = parseFloat(e.target.value);
      document.getElementById('scale-target-value').textContent = config.scaleTarget.toFixed(2);
      updateConfig();
    });

    dart.addEventListener('click', handleDartClick);
    resetButton.addEventListener('click', handleReset);

    // Initialize
    updateConfig();
  </script>
</body>
</html>
